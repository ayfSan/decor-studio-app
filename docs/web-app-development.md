# Глава 2: Разработка веб-приложения

Наше веб-приложение — это не просто сайт, а полноценный инструмент для управления мероприятиями, созданный для работы прямо внутри Телеграма. Это так называемое [Telegram Web App (TWA)](https://core.telegram.org/bots/webapps), что даёт нам возможность сочетать удобство веб-интерфейса с интеграцией в мессенджер.

В этой главе мы простыми словами разберём, из чего состоит приложение, как оно устроено и как связано с нашим Телеграм-ботом.

## На чём всё построено? (Технологии)

В основе нашего приложения лежит **Vue.js 3**. Это современный и гибкий фреймворк, который позволяет создавать быстрые и отзывчивые интерфейсы. Если вы знакомы с HTML, CSS и JavaScript, то разобраться во Vue будет несложно.

Ключевые «кирпичики» нашего проекта:

- **Vue 3 (Composition API)**: Мы используем последнюю версию Vue с её новым подходом к организации кода. Это делает компоненты более читаемыми и простыми для поддержки.
- **Pinia**: Это наш «менеджер состояний». Проще говоря, это хранилище, где лежат общие для всего приложения данные, например, информация о текущем пользователе. Когда данные в Pinia меняются, все компоненты, которые их используют, автоматически обновляются.
- **Vue Router**: Отвечает за навигацию по приложению. Он позволяет создавать разные «страницы» (например, `/events`, `/analytics`, `/settings`) и переключаться между ними без перезагрузки всей страницы.

## Структура проекта: где что лежит?

Все файлы нашего веб-приложения находятся в папке `src`. Давайте пробежимся по основным директориям, чтобы вы могли легко ориентироваться в коде:

- `/components`: Здесь живут многоразовые «кусочки» интерфейса. Например, кнопка, меню или карточка мероприятия. Внутри есть папка `/views`, где лежат целые страницы, которые мы видим в браузере (Главная, Мероприятия и т.д.).
- `/router`: Содержит один файл, который описывает все пути (URL) в приложении и к каким компонентам-страницам они ведут. Здесь же настроена «охрана» маршрутов: система не пустит неавторизованного пользователя на закрытые страницы.
- `/store`: Мозг нашего приложения. Здесь находится логика Pinia. Сейчас тут один ключевой файл `auth.store.js`, который управляет всем, что связано с авторизацией: хранит токен пользователя, его данные и решает, вошёл ли он в систему.
- `/services`: Это наши «помощники» для общения с внешним миром, в первую очередь — с сервером. Файл `api.service.js` отвечает за отправку запросов на бэкенд (например, для получения списка мероприятий или для входа в систему).
- `/utils`: Папка для разных вспомогательных утилит. Самая важная из них — `telegram.js`, которая содержит логику для взаимодействия с клиентом Телеграма.
- `main.js`: Главный файл, с которого начинается запуск всего приложения. Он создаёт экземпляр Vue, подключает роутер, Pinia и инициализирует связь с Телеграмом.

## Как работает авторизация?

Безопасность — это важно. Доступ к CRM есть только у зарегистрированных пользователей. Процесс устроен так:

1.  Пользователь открывает веб-приложение и видит страницу входа.
2.  Он вводит свои данные, которые отправляются на наш сервер.
3.  Сервер проверяет их. Если всё верно, он присылает в ответ специальный **токен** — своего рода цифровой пропуск.
4.  Приложение сохраняет этот токен в `localStorage` браузера. Благодаря этому вам не нужно входить в систему каждый раз, когда вы открываете приложение.
5.  При каждом следующем запросе к серверу (например, при попытке открыть список клиентов) этот токен автоматически прикрепляется к запросу, и сервер понимает, кто к нему обращается.

Этот механизм реализован в файлах `src/router/index.js` (проверка прав доступа) и `src/store/auth.store.js` (логика входа, выхода и хранения токена).

## Связь с Телеграм-ботом

Как мы уже выяснили, наше приложение — это TWA. Это означает, что **веб-приложение является визуальным интерфейсом для нашего Телеграм-бота**.

Пользователь взаимодействует с ботом в чате, нажимает на кнопку, и бот открывает ему наше веб-приложение прямо в интерфейсе мессенджера.

Технически это работает так:

- В файле `src/main.js` при старте приложения вызывается функция `telegram.init()`.
- Эта функция инициализирует скрипт, предоставляемый самим Телеграмом (`telegram-web-app.js`).
- Через утилиту `src/utils/telegram.js` мы можем управлять поведением приложения внутри Телеграма: например, растянуть окно на весь экран, закрыть его, передать какие-то данные обратно боту и многое другое.

Таким образом, бот служит точкой входа и может выполнять какие-то базовые команды, а веб-приложение предоставляет сложный, интерактивный и удобный интерфейс для основной работы. Это мощная связка, которая делает наш продукт удобным и современным.
